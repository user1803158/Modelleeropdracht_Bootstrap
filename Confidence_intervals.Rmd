---
title: "Modelleren_CI"
output: html_document
date: '2023-03-07'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

Moeten estimator functie hebben
ronden B*alpha af naar boven als het geen geheel getal is

bootstrap_samples is vector met alle bootstrap samples
sample is vector met de originele sample
estimator is functie van de sample x, die dus theta dakje van x geeft
alpha is waarde van alpha

```
stderror <- function(x) sd(x)/sqrt(length(x))

BCa <- function(bootstrap_samples, sample, estimator, alpha) {
   B <- length(bootstrap_samples)
   bootstrap_est = rep(0, B)
   
   for(i in B){
   bootstrap_est[i] <- estimator(bootstrap_samples[i])
   }
   
   number <- 0
   x <- list(sample)
   theta <- rep(0, length(sample)-1)
   
   for(i in B) 
   {
   if(bootstrap_est[i] < estimator(sample)
   number <- number + 1
   }
   
   z0 <- qnorm(number/B)
   
   for(i in length(sample))
   {
   x_i <- sample[-i]
   theta[i] <- estimator(x_i)
   }
   
   theta_mean <- mean(theta[])
   
   teller <- c((theta_mean - theta[i])^3)
   noemer <- c((theta_mean - theta[i])^2)
   
   a <- sum(teller)/(6*(sum(noemer))^(3/2))
   
   alpha_1 <- pnorm(z0 + (z0 + qnorm(alpha/2))/(1 - a(z0 + qnorm(alpha/2))))
   alpha_2 <- pnorm(z0 + (z0 + qnorm(1-alpha/2))/(1 - a(z0 + qnorm(1-alpha/2))))
   
   sort(bootstrap_est)
   
   theta_lo <- bootstrap_est[round(B * alpha_1, digits = 0)]
   theta_up <- bootstrap_est[round(B * alpha_2, digits = 0)]
   
   CI <- c(theta_lo, theta_up)
   
   return CI
}

Bootstrap_t <- function(bootstrap_samples, sample, estimator, alpha) {
   B <- length(bootstrap_samples)
   Z <- rep(0, B)
   
   for(i in B)
   Z[i] <- (estimator(bootstrap_samples[i])- estimator(sample))/stderror(bootstrap_samples[i])
   
   sort(Z)
   
   h1 <- round(B * alpha/2)
   h2 <- round(B * (1-alpha/2))
   
   t1 <- Z[h1]
   t2 <- Z[h2]
   
   theta_lo <- estimator(sample)-t2*stderror(sample)
   theta_up <- estimator(sample)-t1*stderror(sample)
   
   CI <- c(theta_lo, theta_up)
   
   return CI
}   
   
   
Basic <- function(bootstrap_samples, sample, estimator, alpha) {
  B <- length(bootstrap_samples)
  bootstrap_est = rep(0, B)
   
  for(i in B){
  bootstrap_est[i] <- estimator(bootstrap_samples[i])
  }
  
  sort(bootstrap_est)
  
  
  h1 <- round(B * alpha/2)
  h1 <- round(B * (1-alpha/2))
  
  theta_lo <- bootstrap_est[h1]
  theta_up <- bootstrap_est[h2]
  
  CI <- c(theta_lo, theta_up)
   
  return CI
}



```
