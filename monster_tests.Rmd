---
title: "Bootstrap Testing"
author: "Koen Bresters"
date: "2023-02-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# import the monster function
source("monster_functie.r")

# define a nice plotting function
niceplot <- function(variance_data, title){
  hist(variance_data, xlab="estimated variance", main=title)
  mtext(paste("Mean Square Error = ", as.character(mean((variance_data-true_variance)^2))), side=4)
  abline(v=true_variance, col="red")
}

# some global parameters
alphas = c(0.001, 0.01, 0.05, 0.1)

```

## normal dist with 0 mean parametric

```{r}
mean0norm <- function (sd){
  function(N){
    rnorm(N, mean=0, sd=sd)
  }
}

true_param = 1

param_monster(true_distr_gen=mean0norm, true_params=true_param, params_estimator=function(x) sd(x), n=100, N=1000, M=300, true_variance_N=10000, true_theta=true_param, alphas=alphas)
```

## normal dist with unknown mean parametric

```{r}
normdist <- function (x){
  function(N){
    rnorm(N, mean=x$mean, sd=x$sd)
  }
}

full_estimator <- function(x) list(mean=mean(x), sd=sd(x))
estimator <- function(x) sd(x)
true_params = list(mean=0, sd=1)

param_monster(true_distr_gen=normdist, true_params=true_params, params_estimator=full_estimator, estimator=estimator, n=100, N=1000, M=300, true_variance_N=10000, true_theta=true_params$sd, alphas=alphas)
```

## normal dist non-parametric

```{r}
distr = normdist(list(mean=0, sd=1))
estimator = function(x) sd(x)
true_theta = 1
nonparam_monster(distr, estimator, true_theta, n=100, M=300, N=1000, true_variance_N=10000, alphas=alphas)
```
